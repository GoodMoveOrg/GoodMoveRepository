<?xml version="1.0" encoding="UTF-8"?>
<!-- Sql Mapper -->
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="board"> 	
	<sql id="selectBoard">
	 select bno,title,hit,to_char(time_posted,'YYYY.MM.DD HH:mm') as time_posted,
	 id,addr,bcontent,thumbpath from G_BOARD
	</sql>
	<select id="getNextBno" resultType="int">
		select B_SEQ.nextval from dual
	</select>
	<select id="getNextPno" resultType="int">
		select P_SEQ.nextval from dual
	</select>
	<select id="getAllBoardList" resultType="BoardVO" parameterType="boardPagingBean">
		select * from (
		select bno, title, hit, to_char(time_posted,'YYYY.MM.DD HH:mm') as time_posted, 
		id, addr,bcontent, thumbpath, row_number() over(order by bno desc) as rnum from G_BOARD) 
		where rnum between #{startRowNumber} and #{endRowNumber}
	</select>
	<select id="getTotalBoardCount" resultType="int">
		select count(*) from G_BOARD
	</select>
	<select id="boardRegister" parameterType="boardVO">
		INSERT INTO G_BOARD(BNO, ID, TITLE, BCONTENT, ADDR, TIME_POSTED, HIT, THUMBPATH) 
		VALUES(#{bno}, #{id}, #{title}, #{bcontent}, #{addr}, sysdate, 0, #{thumbPath})
	</select>
	<select id="productRegister" parameterType="productVO">
		INSERT INTO G_PRODUCT(BNO, PNO, PTITLE, KIND, PCONTENT, IMG_PATH) 
		VALUES(#{bno}, #{pno}, #{ptitle}, #{kind}, #{pcontent}, #{img_path})
		</select>
	<select id="getBoardDetailByBno" parameterType="int" resultType="boardVO">
	 	<include refid="selectBoard"/> where bno=#{value}
	</select>
	<select id="getProductImgByBno" parameterType="int" resultType="productVO">
		select * from G_PRODUCT where bno=#{value}
	</select>
</mapper>
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
















